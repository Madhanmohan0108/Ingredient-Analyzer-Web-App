<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Ingredient Analyzer | AI-Powered</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Poppins', sans-serif;
            background: radial-gradient(circle at top right, #0d1b2a, #000000);
            color: #fff;
            overflow-x: hidden;
        }
        
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 8%;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            position: fixed;
            width: 100%;
            z-index: 1000;
        }
        
        .logo { font-size: 1.8rem; font-weight: 700; color: #00f6ff; }
        .logo span { color: #39ff14; }
        .nav-links { list-style: none; display: flex; gap: 25px; }
        .nav-links a { text-decoration: none; color: #ddd; font-weight: 400; transition: 0.3s; cursor: pointer; }
        .nav-links a:hover { color: #00f6ff; }
        .cta { background: linear-gradient(90deg, #00f6ff, #39ff14); border: none; padding: 10px 20px; border-radius: 50px; color: #000; font-weight: 600; cursor: pointer; transition: 0.3s; }
        .cta:hover { transform: scale(1.05); }
        
        .hero {
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            position: relative;
            padding: 0 10%;
            margin-top: 60px;
        }
        
        .hero h1 { font-size: 3rem; margin-bottom: 15px; }
        .hero h1 span { color: #00f6ff; }
        .hero p { color: #ccc; margin-bottom: 25px; }
        .hero-btn { background: linear-gradient(90deg, #00f6ff, #39ff14); color: #000; padding: 12px 25px; border-radius: 50px; border: none; cursor: pointer; font-weight: 600; font-size: 1rem; transition: 0.3s; }
        .hero-btn:hover { transform: scale(1.08); }
        
        .features { padding: 100px 10%; background: rgba(255,255,255,0.02); }
        .section-title { text-align: center; font-size: 2rem; margin-bottom: 40px; }
        .section-title span { color: #39ff14; }
        
        .feature-container { display: flex; justify-content: center; gap: 30px; flex-wrap: wrap; }
        .feature-card {
            background: rgba(255,255,255,0.05);
            border-radius: 20px;
            padding: 30px;
            width: 300px;
            text-align: center;
            backdrop-filter: blur(10px);
            transition: 0.4s;
        }
        .feature-card:hover { transform: translateY(-10px); box-shadow: 0 0 25px rgba(0,255,255,0.2); }
        .feature-card h3 { color: #00f6ff; margin-bottom: 10px; }
        
        .upload-section { padding: 100px 10%; text-align: center; }
        .upload-container {
            background: rgba(255,255,255,0.05);
            border-radius: 25px;
            padding: 50px;
            margin: 0 auto;
            max-width: 800px;
            backdrop-filter: blur(10px);
            border: 2px dashed rgba(0,255,255,0.3);
            transition: 0.3s;
            cursor: pointer;
        }
        .upload-container:hover {
            border-color: rgba(0,255,255,0.8);
            box-shadow: 0 0 25px rgba(0,255,255,0.2);
        }
        
        .upload-icon { font-size: 3rem; margin-bottom: 20px; }
        .upload-container h3 { color: #00f6ff; margin-bottom: 10px; }
        .upload-container p { color: #aaa; margin-bottom: 20px; }
        .upload-input { display: none; }
        
        .image-preview { margin-top: 30px; display: none; text-align: center; }
        .image-preview img { max-width: 100%; max-height: 300px; border-radius: 15px; margin-bottom: 20px; }
        
        .hidden { display: none !important; }
        
        .loading-section { padding: 100px 10%; text-align: center; }
        .loader {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(0,255,255,0.2);
            border-top: 4px solid #00f6ff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 30px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .phase {
            padding: 20px;
            margin: 10px 0;
            background: rgba(255,255,255,0.05);
            border-left: 4px solid transparent;
            border-radius: 8px;
            transition: 0.3s;
            text-align: left;
        }
        
        .phase.active { background: rgba(0,255,255,0.1); border-left-color: #00f6ff; }
        .phase.complete { border-left-color: #39ff14; }
        
        .analysis-preview { padding: 100px 10%; text-align: center; }
        .analysis-card {
            background: rgba(255,255,255,0.05);
            border-radius: 25px;
            padding: 40px;
            margin: 0 auto;
            max-width: 800px;
            backdrop-filter: blur(10px);
        }
        
        .analysis-card h3 { color: #00f6ff; font-size: 1.8rem; margin-bottom: 10px; }
        .product-info { margin: 20px 0; color: #ccc; }
        
        .confidence-display { margin: 20px 0; }
        .confidence-bar {
            width: 100%;
            height: 12px;
            background: rgba(0,255,255,0.1);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, #00f6ff, #39ff14);
            border-radius: 10px;
            animation: fillWidth 1.5s ease-out;
        }
        
        @keyframes fillWidth {
            from { width: 0%; }
        }
        
        .confidence-text { font-size: 1.2rem; color: #00f6ff; font-weight: 600; }
        
        .color-scale {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            align-items: center;
            font-size: 0.9rem;
        }
        
        .color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            display: inline-block;
        }
        
        .red { background: #ff3b3b; }
        .yellow { background: #ffcc00; }
        .green { background: #39ff14; }
        
        .ingredient-list { display: flex; flex-direction: column; gap: 8px; margin-top: 15px; text-align: left; }
        .ingredient {
            padding: 10px 15px;
            border-radius: 10px;
            text-align: left;
            font-weight: 500;
        }
        
        .harmful { background: rgba(255, 59, 59, 0.15); border-left: 4px solid #ff3b3b; }
        .moderate { background: rgba(255, 204, 0, 0.15); border-left: 4px solid #ffcc00; }
        .safe { background: rgba(57, 255, 20, 0.15); border-left: 4px solid #39ff14; }
        
        .filter-buttons { display: flex; justify-content: center; gap: 10px; margin: 20px 0; flex-wrap: wrap; }
        .filter {
            background: rgba(0,255,255,0.1);
            border: 1px solid rgba(0,255,255,0.3);
            color: #00f6ff;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            transition: 0.3s;
        }
        
        .filter:hover, .filter.active {
            background: rgba(0,255,255,0.3);
            border-color: #00f6ff;
        }
        
        footer { text-align: center; padding: 20px; font-size: 0.9rem; color: #888; border-top: 1px solid rgba(255,255,255,0.1); }
        footer span { color: #39ff14; }
        
        @media (max-width: 768px) {
            .hero h1 { font-size: 2rem; }
            .hero { padding: 0 5%; }
            .features { padding: 50px 5%; }
            .upload-section { padding: 50px 5%; }
        }
    </style>
</head>
<body>

<nav class="navbar">
    <div class="logo">Ingredient<span>Analyzer</span></div>
    <ul class="nav-links">
        <li><a onclick="showSection('hero')">Home</a></li>
        <li><a onclick="showSection('features')">Features</a></li>
        <li><a onclick="showSection('upload')">Analyze</a></li>
    </ul>
    <button class="cta" onclick="showSection('upload')">Get Started</button>
</nav>

<section id="hero" class="hero">
    <div>
        <h1>Analyze Ingredients with <span>AI Precision</span></h1>
        <p>Upload any product label and instantly detect harmful, moderate, or safe ingredients ‚Äî powered by AI and OCR.</p>
        <button class="hero-btn" onclick="showSection('upload')">Start Analyzing</button>
    </div>
</section>

<section id="features" class="features">
    <h2 class="section-title">Why Choose Ingredient<span>Analyzer</span>?</h2>
    <div class="feature-container">
        <div class="feature-card">
            <h3>üì∑ OCR Technology</h3>
            <p>Extract ingredients from product images automatically.</p>
        </div>
        <div class="feature-card">
            <h3>üß™ AI Analysis</h3>
            <p>Classify harmful, moderate, and safe ingredients intelligently.</p>
        </div>
        <div class="feature-card">
            <h3>üéØ Brand Identification</h3>
            <p>Identify specific brands based on ingredient patterns.</p>
        </div>
        <div class="feature-card">
            <h3>üìö Wikipedia Integration</h3>
            <p>Get instant information for each ingredient.</p>
        </div>
        <div class="feature-card">
            <h3>üî¨ Health Conditions</h3>
            <p>Filter based on your health conditions.</p>
        </div>
        <div class="feature-card">
            <h3>‚ö° Instant Results</h3>
            <p>Get color-coded results instantly.</p>
        </div>
    </div>
</section>

<section id="upload" class="upload-section hidden">
    <h2 class="section-title">Upload Product <span>Image</span></h2>
    
    <div class="upload-container" id="uploadZone">
        <div class="upload-icon">üì∏</div>
        <h3>Drag & Drop or Click to Upload</h3>
        <p>Supported formats: JPG, PNG, BMP (Max 10MB)</p>
        <input type="file" id="imageInput" class="upload-input" accept="image/*">
    </div>

    <div class="image-preview" id="imagePreview">
        <img id="previewImage" src="" alt="Preview">
        <button class="hero-btn" onclick="analyzeImage()">üöÄ Analyze Ingredients</button>
        <button class="cta" onclick="resetUpload()" style="margin-left: 10px;">üîÑ Upload Different</button>
    </div>
</section>

<section id="loading" class="loading-section hidden">
    <h2 class="section-title">Analyzing <span>Product</span>...</h2>
    <div class="loader"></div>

    <div class="phase active" id="phase1">
        <div><strong>üì∑ Phase 1: Extracting Ingredients</strong></div>
        <div style="color: #aaa; font-size: 0.9rem;">Scanning image with OCR...</div>
    </div>

    <div class="phase" id="phase2">
        <div><strong>üß™ Phase 2: Analyzing Safety</strong></div>
        <div style="color: #aaa; font-size: 0.9rem;">Checking against chemical database...</div>
    </div>

    <div class="phase" id="phase3">
        <div><strong>üéØ Phase 3: Identifying Brand</strong></div>
        <div style="color: #aaa; font-size: 0.9rem;">Matching to known products...</div>
    </div>

    <p style="margin-top: 20px; color: #aaa;">Estimated time: 3-5 seconds</p>
</section>

<section id="results" class="analysis-preview hidden">
    <button class="hero-btn" onclick="showSection('upload')" style="margin-bottom: 20px;">‚Üê Back</button>

    <div class="analysis-card">
        <h3 id="brandName">Unknown Brand</h3>
        <p id="productName" class="product-info">Generic Product</p>

        <div class="confidence-display">
            <div class="confidence-bar">
                <div class="confidence-fill" id="confidenceFill"></div>
            </div>
            <div class="confidence-text" id="confidenceText">0% Match</div>
        </div>

        <div class="color-scale">
            <span class="color red"></span> Harmful
            <span class="color yellow"></span> Moderate
            <span class="color green"></span> Safe
        </div>

        <h3 style="margin-top: 30px; color: #00f6ff;">üß¨ Detected Ingredients</h3>

        <div class="filter-buttons">
            <button class="filter active" onclick="filterIngredients(event, 'all')">All</button>
            <button class="filter" onclick="filterIngredients(event, 'safe')">‚úì Safe</button>
            <button class="filter" onclick="filterIngredients(event, 'moderate')">‚ö† Moderate</button>
            <button class="filter" onclick="filterIngredients(event, 'harmful')">‚úó Harmful</button>
        </div>

        <div class="ingredient-list" id="ingredientsList"></div>

        <h3 style="margin-top: 30px; color: #39ff14;">üìã Recommendation</h3>
        <p id="recommendations" style="color: #ccc; margin-top: 10px;"></p>

        <button class="hero-btn" onclick="analyzeAnother()" style="margin-top: 30px; width: 100%;">üì§ Analyze Another</button>
    </div>
</section>

<footer>
    <p>¬© 2025 Ingredient<span>Analyzer</span>. Built with AI & Django</p>
</footer>

<script>
    const API_ENDPOINT = '/api/analyze/';
    let currentAnalysis = null;
    let currentImage = null;

    document.addEventListener('DOMContentLoaded', () => {
        setupUploadZone();
    });

    function setupUploadZone() {
        const uploadZone = document.getElementById('uploadZone');
        const imageInput = document.getElementById('imageInput');

        uploadZone.addEventListener('click', () => imageInput.click());

        uploadZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadZone.style.borderColor = '#39ff14';
        });

        uploadZone.addEventListener('dragleave', () => {
            uploadZone.style.borderColor = 'rgba(0,255,255,0.3)';
        });

        uploadZone.addEventListener('drop', (e) => {
            e.preventDefault();
            if (e.dataTransfer.files.length > 0) {
                handleImageUpload(e.dataTransfer.files[0]);
            }
        });

        imageInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleImageUpload(e.target.files[0]);
            }
        });
    }

    function handleImageUpload(file) {
        if (!file.type.startsWith('image/')) {
            alert('Please upload a valid image file');
            return;
        }
        if (file.size > 10 * 1024 * 1024) {
            alert('File too large. Maximum 10MB');
            return;
        }
        currentImage = file;
        const reader = new FileReader();
        reader.onload = (e) => {
            document.getElementById('previewImage').src = e.target.result;
            document.getElementById('imagePreview').style.display = 'block';
        };
        reader.readAsDataURL(file);
    }

    async function analyzeImage() {
        if (!currentImage) {
            alert('Please upload an image first');
            return;
        }
        showSection('loading');
        const formData = new FormData();
        formData.append('image', currentImage);
        try {
            await new Promise(r => setTimeout(r, 1000));
            document.getElementById('phase1').classList.add('complete');
            await new Promise(r => setTimeout(r, 1000));
            document.getElementById('phase2').classList.add('active');
            await new Promise(r => setTimeout(r, 1000));
            document.getElementById('phase2').classList.add('complete');
            document.getElementById('phase3').classList.add('active');
            const response = await fetch(API_ENDPOINT, { method: 'POST', body: formData });
            if (!response.ok) throw new Error(`API error: ${response.statusText}`);
            const data = await response.json();
            await new Promise(r => setTimeout(r, 500));
            document.getElementById('phase3').classList.add('complete');
            displayResults(data);
        } catch (error) {
            alert(`Analysis failed: ${error.message}`);
            showSection('upload');
        }
    }

    function displayResults(data) {
        currentAnalysis = data;
        document.getElementById('brandName').textContent = data.identified_brand.name;
        document.getElementById('productName').textContent = data.identified_brand.product_name || 'Product';
        const confidence = Math.round(data.overall_confidence);
        document.getElementById('confidenceFill').style.width = confidence + '%';
        document.getElementById('confidenceText').textContent = confidence + '% Match';
        
        const ingredientsList = document.getElementById('ingredientsList');
        ingredientsList.innerHTML = '';
        data.unsafe_ingredients.forEach((ing) => {
            const item = document.createElement('div');
            item.className = `ingredient ${ing.safety.toLowerCase()}`;
            item.setAttribute('data-category', ing.safety.toLowerCase());
            item.innerHTML = `<strong>${ing.ingredient}</strong><br><span style="font-size: 0.9rem; color: #aaa;">${ing.effect}</span>`;
            ingredientsList.appendChild(item);
        });
        
        document.getElementById('recommendations').textContent = data.recommendations || 'Analysis complete.';
        setTimeout(() => showSection('results'), 500);
    }

    function filterIngredients(event, category) {
        document.querySelectorAll('.filter').forEach(btn => btn.classList.remove('active'));
        event.target.classList.add('active');
        const items = document.querySelectorAll('.ingredient-list .ingredient');
        items.forEach(item => {
            if (category === 'all') {
                item.style.display = 'block';
            } else {
                item.style.display = item.getAttribute('data-category') === category ? 'block' : 'none';
            }
        });
    }

    function showSection(sectionId) {
        document.getElementById('hero').classList.add('hidden');
        document.getElementById('features').classList.add('hidden');
        document.getElementById('upload').classList.add('hidden');
        document.getElementById('loading').classList.add('hidden');
        document.getElementById('results').classList.add('hidden');
        document.getElementById(sectionId).classList.remove('hidden');
        
        if (sectionId === 'loading') {
            document.getElementById('phase1').classList.add('active');
            document.getElementById('phase1').classList.remove('complete');
            document.getElementById('phase2').classList.remove('active', 'complete');
            document.getElementById('phase3').classList.remove('active', 'complete');
        }
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function resetUpload() {
        document.getElementById('imageInput').value = '';
        document.getElementById('imagePreview').style.display = 'none';
        currentImage = null;
    }

    function analyzeAnother() {
        resetUpload();
        showSection('upload');
    }
</script>

</body>
</html>
